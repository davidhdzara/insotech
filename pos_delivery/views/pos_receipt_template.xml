<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        
        <!-- POS Receipt Template for Web View -->
        <template id="pos_receipt_template" name="POS Receipt HTML">
            <t t-call="web.html_container">
                <div class="container mt-5">
                    <div class="row justify-content-center">
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-body" style="font-family: 'Courier New', monospace; font-size: 14px;">
                                    
                                    <!-- Header -->
                                    <div class="text-center mb-3">
                                        <h4><t t-esc="receipt_data.get('name', '')"/></h4>
                                        <p class="mb-0" t-if="receipt_data.get('cashier')">
                                            Atendido por: <t t-esc="receipt_data.get('cashier', '')"/>
                                        </p>
                                    </div>
                                    
                                    <!-- Order Creation Date/Time -->
                                    <div class="text-center mb-3" style="font-size: 1.1em;" t-if="receipt_data['creation_date']">
                                        <strong>Fecha y Hora:</strong><br/>
                                        <strong style="font-size: 1.2em;"><t t-esc="receipt_data['creation_date']"/></strong>
                                    </div>
                                    
                                    <!-- Customer Information -->
                                    <t t-if="receipt_data.get('partner')">
                                        <div class="mb-3">
                                            <div class="text-center">--------------------------------</div>
                                            <div class="text-center"><strong>INFORMACIÓN DEL CLIENTE</strong></div>
                                            <div class="text-center">--------------------------------</div>
                                            
                                            <div t-if="receipt_data['partner'].get('name')">
                                                <strong>Nombre:</strong> <t t-esc="receipt_data['partner']['name']"/>
                                            </div>
                                            
                                            <div t-if="receipt_data['partner'].get('document_type') or receipt_data['partner'].get('document_number')">
                                                <strong>
                                                    <t t-if="receipt_data['partner'].get('document_type')">
                                                        <t t-esc="receipt_data['partner']['document_type']"/>:
                                                    </t>
                                                    <t t-else="">Documento:</t>
                                                </strong>
                                                <t t-esc="receipt_data['partner'].get('document_number', '')"/>
                                            </div>
                                            
                                            <div t-if="receipt_data['partner'].get('vat')">
                                                <strong>NIT/VAT:</strong> <t t-esc="receipt_data['partner']['vat']"/>
                                            </div>
                                            
                                            <t t-if="receipt_data['partner'].get('street') or receipt_data['partner'].get('city')">
                                                <div>
                                                    <strong>Dirección:</strong><br/>
                                                    <t t-if="receipt_data['partner'].get('street')">
                                                        <t t-esc="receipt_data['partner']['street']"/><br/>
                                                    </t>
                                                    <t t-if="receipt_data['partner'].get('street2')">
                                                        <t t-esc="receipt_data['partner']['street2']"/><br/>
                                                    </t>
                                                    <t t-if="receipt_data['partner'].get('city')">
                                                        <t t-esc="receipt_data['partner']['city']"/>
                                                    </t>
                                                    <t t-if="receipt_data['partner'].get('state_id')">
                                                        , <t t-esc="receipt_data['partner']['state_id']"/>
                                                    </t>
                                                    <t t-if="receipt_data['partner'].get('zip')">
                                                        - <t t-esc="receipt_data['partner']['zip']"/>
                                                    </t>
                                                </div>
                                            </t>
                                            
                                            <div t-if="receipt_data['partner'].get('phone')">
                                                <strong>Teléfono:</strong> <t t-esc="receipt_data['partner']['phone']"/>
                                            </div>
                                            
                                            <div t-if="receipt_data['partner'].get('mobile')">
                                                <strong>Celular:</strong> <t t-esc="receipt_data['partner']['mobile']"/>
                                            </div>
                                            
                                            <div class="text-center">--------------------------------</div>
                                        </div>
                                    </t>
                                    
                                    <!-- Order Lines -->
                                    <div class="mb-3">
                                        <t t-foreach="receipt_data.get('orderlines', [])" t-as="line">
                                            <div class="d-flex justify-content-between">
                                                <div>
                                                    <t t-esc="line.get('product_name', '')"/>
                                                    <br/>
                                                    <small>
                                                        <t t-esc="'%.2f' % line.get('quantity', 0)"/> x 
                                                        $<t t-esc="'{:,.2f}'.format(line.get('price', 0))"/>
                                                    </small>
                                                    <t t-if="line.get('customer_note')">
                                                        <br/>
                                                        <small><em><t t-esc="line.get('customer_note', '')"/></em></small>
                                                    </t>
                                                </div>
                                                <div>
                                                    $<t t-esc="'{:,.2f}'.format(line.get('price_display', 0))"/>
                                                </div>
                                            </div>
                                        </t>
                                    </div>
                                    
                                    <hr/>
                                    
                                    <!-- Totals -->
                                    <div class="mb-3">
                                        <div class="text-center">--------------------------------</div>
                                        
                                        <!-- Payment Methods -->
                                        <t t-if="receipt_data.get('paymentlines')">
                                            <div class="d-flex justify-content-between mb-2">
                                            <strong>Total a pagar:</strong>
                                            <strong>$<t t-esc="'{:,.2f}'.format(receipt_data.get('amount_total', 0))"/></strong>
                                        </div>
                                            <t t-foreach="receipt_data.get('paymentlines', [])" t-as="payment">
                                                <div class="d-flex justify-content-between">
                                                    <span><t t-esc="payment.get('name', '')"/></span>
                                                    <span>$<t t-esc="'{:,.2f}'.format(payment.get('amount', 0))"/></span>
                                                </div>
                                            </t>
                                        </t>                                        
                                        
                                        <!-- Change -->
                                        <div class="d-flex justify-content-between mb-2" t-if="receipt_data.get('order_change', 0) > 0.01">
                                            <span>Cambio:</span>
                                            <span>$<t t-esc="'{:,.2f}'.format(receipt_data.get('order_change', 0))"/></span>
                                        </div>
                                        
                                        <!-- Delivery Cost and Payment Method -->
                                        <t t-if="receipt_data.get('delivery_cost', 0) > 0">
                                            <div class="text-center mt-2 mb-2">--------------------------------</div>
                                            <div class="d-flex justify-content-between">
                                                <span>Costo de Envío:</span>
                                                <span>$<t t-esc="'{:,.2f}'.format(receipt_data.get('delivery_cost', 0))"/></span>
                                            </div>
                                            <div class="d-flex justify-content-between" t-if="receipt_data.get('delivery_payment_method')">
                                                <span>Método de Pago de Envío:</span>
                                                <span><t t-esc="receipt_data.get('delivery_payment_method', '')"/></span>
                                            </div>
                                        </t>
                                    </div>
                                    
                                    <hr/>
                                    
                                    <!-- General Note -->
                                    <t t-if="receipt_data.get('general_note')">
                                        <div class="mb-3">
                                            <div class="text-center">--------------------------------</div>
                                            <div class="text-center"><strong>NOTA</strong></div>
                                            <div class="text-center">--------------------------------</div>
                                            <p style="white-space: pre-line;"><t t-esc="receipt_data.get('general_note', '')"/></p>
                                            <div class="text-center">--------------------------------</div>
                                        </div>
                                    </t>
                                    
                                    <!-- Footer -->
                                    <div class="text-center">
                                        <t t-if="receipt_data.get('footer')">
                                            <p class="mb-2" style="white-space: pre-line;"><t t-esc="receipt_data['footer']"/></p>
                                        </t>
                                    </div>
                                    
                                    <!-- Print Button -->
                                    <div class="text-center mt-4">
                                        <button onclick="window.print()" class="btn btn-primary">
                                            <i class="fa fa-print"/> Imprimir
                                        </button>
                                        <button onclick="window.close()" class="btn btn-secondary">
                                            <i class="fa fa-times"/> Cerrar
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </t>
        </template>
        
        <!-- Receipt Not Found Template -->
        <template id="receipt_not_found" name="Receipt Not Found">
            <t t-call="web.html_container">
                <div class="container mt-5">
                    <div class="alert alert-danger text-center">
                        <h4>Recibo no encontrado</h4>
                        <p>La orden solicitada no existe o no tiene permisos para verla.</p>
                    </div>
                </div>
            </t>
        </template>
        
        <!-- Receipt Error Template -->
        <template id="receipt_error" name="Receipt Error">
            <t t-call="web.html_container">
                <div class="container mt-5">
                    <div class="alert alert-danger text-center">
                        <h4>Error al generar el recibo</h4>
                        <p><t t-esc="error"/></p>
                    </div>
                </div>
            </t>
        </template>
        
    </data>
</odoo>

