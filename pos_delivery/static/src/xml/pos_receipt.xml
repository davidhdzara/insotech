<?xml version="1.0" encoding="utf-8"?>
<templates id="template" xml:space="preserve">

    <t t-inherit="point_of_sale.OrderReceipt" t-inherit-mode="extension">
        <!-- Add customer information after the header and before the products -->
        <xpath expr="//ReceiptHeader" position="after">
            <t t-if="props.data.partner and (props.data.partner.name or props.data.partner.street or props.data.partner.phone or props.data.partner.mobile)">
                <br/>
                <div class="text-center">--------------------------------</div>
                <div class="text-center fw-bold">INFORMACIÓN DEL CLIENTE</div>
                <div class="text-center">--------------------------------</div>
                
                <div t-if="props.data.partner.name">
                    <strong>Nombre:</strong> <t t-esc="props.data.partner.name"/>
                </div>
                
                <div t-if="props.data.partner.document_type or props.data.partner.document_number">
                    <strong>
                        <t t-if="props.data.partner.document_type">
                            <t t-esc="props.data.partner.document_type"/>:
                        </t>
                        <t t-else="">Documento:</t>
                    </strong>
                    <t t-esc="props.data.partner.document_number"/>
                </div>
                
                <div t-if="props.data.partner.vat">
                    <strong>NIT/VAT:</strong> <t t-esc="props.data.partner.vat"/>
                </div>
                
                <t t-if="props.data.partner.street or props.data.partner.street2 or props.data.partner.city">
                    <div>
                        <strong>Dirección:</strong><br/>
                        <t t-if="props.data.partner.street">
                            <t t-esc="props.data.partner.street"/><br/>
                        </t>
                        <t t-if="props.data.partner.street2">
                            <t t-esc="props.data.partner.street2"/><br/>
                        </t>
                        <t t-if="props.data.partner.city or props.data.partner.state_id or props.data.partner.zip">
                        <t t-if="props.data.partner.city">
                            <t t-esc="props.data.partner.city"/>
                        </t>
                        <t t-if="props.data.partner.state_id">
                            , <t t-esc="props.data.partner.state_id"/>
                        </t>
                        <t t-if="props.data.partner.zip">
                            - <t t-esc="props.data.partner.zip"/>
                            </t>
                            <br/>
                        </t>
                        <t t-if="props.data.partner.country_id">
                            <t t-esc="props.data.partner.country_id"/><br/>
                        </t>
                    </div>
                </t>
                
                <div t-if="props.data.partner.phone">
                    <strong>Teléfono:</strong> <t t-esc="props.data.partner.phone"/>
                </div>
                
                <div t-if="props.data.partner.mobile">
                    <strong>Celular:</strong> <t t-esc="props.data.partner.mobile"/>
                    </div>
                
                <div class="text-center">--------------------------------</div>
                <br/>
            </t>
            
            <!-- Add order creation date/time -->
            <t t-if="props.data.creation_date">
                <div class="text-center mb-2">
                    <strong>Fecha y Hora:</strong><br/>
                    <t t-esc="props.data.creation_date"/>
                </div>
                <br/>
            </t>
        </xpath>
        
        <!-- Add internal note after customer note in orderlines -->
        <xpath expr="//OrderWidget/Orderline/li[@t-if='line.customerNote']" position="after">
            <li t-if="line.internalNote" class="internal-note w-100 p-2 my-1 rounded text-break" style="font-style: italic; background-color: #f0f0f0;">
                <i class="fa fa-file-text-o me-1" role="img" aria-label="Internal Note" title="Internal Note"/>
                <t t-esc="line.internalNote" />
            </li>
        </xpath>
    </t>

</templates>

